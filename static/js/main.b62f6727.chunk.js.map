{"version":3,"sources":["../../src/Stl.js","../../src/index.js","App.js","index.js"],"names":["StlViewer","volume","useEffect","scene","camera","width","cameraTarget","renderer","antialias","alpha","preserveDrawingBuffer","document","controls","OrbitControls","ground","color","depthWrite","Math","grid","hemiLight","directionalLight","loader","geometry","material","specular","shininess","mesh","signedVolumeOfTriangle","p1","p2","p3","position","faces","sum","i","window","render","animate","requestAnimationFrame","Stl","id","App","useState","photo","setphoto","setvolume","flexGrow","padding","border","as","size","height","url","groundColor","objectColor","skyboxColor","gridLineColor","lightColor","toFixed","src","onClick","getElementsByTagName","toDataURL","ReactDOM","resetCSS","getElementById"],"mappings":"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","file":"static/js/main.b62f6727.chunk.js","sourcesContent":["import * as THREE from 'three'\nimport { STLLoader } from 'three/examples/jsm/loaders/STLLoader'\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls'\n\nlet camera, cameraTarget, scene, renderer, controls\nexport default function Stl(\n  width,\n  height,\n  url,\n  objectColor,\n  gridLineColor,\n  skyboxColor,\n  groundColor,\n  lightColor,\n  volume\n) {\n  // scene setup\n\n  scene = new THREE.Scene()\n  scene.background = new THREE.Color(skyboxColor)\n  scene.fog = new THREE.Fog(0xa0a0a0, 200, 1000)\n\n  // camera setup\n  camera = new THREE.PerspectiveCamera(45, width / height, 1, 1000)\n  camera.position.set(200, 100, 200)\n\n  cameraTarget = new THREE.Vector3(0, 0, 0)\n\n  // renderer setup\n  renderer = new THREE.WebGLRenderer({\n    antialias: true,\n    alpha: true,\n    preserveDrawingBuffer: true\n  })\n  renderer.setSize(width, height)\n\n  // where to render your scene\n  document.getElementById('stlviewer').innerHTML = ''\n  document.getElementById('stlviewer').appendChild(renderer.domElement)\n\n  // controls\n  controls = new OrbitControls(camera, renderer.domElement)\n  controls.target.set(0, 0, 0)\n  controls.update()\n\n  // ground\n\n  const ground = new THREE.Mesh(\n    new THREE.PlaneGeometry(2000, 2000),\n    new THREE.MeshPhongMaterial({ color: groundColor, depthWrite: false })\n  )\n  ground.rotation.x = -Math.PI / 2\n  ground.receiveShadow = true\n  scene.add(ground)\n\n  const grid = new THREE.GridHelper(2000, 20, gridLineColor, gridLineColor)\n  grid.material.opacity = 0.2\n  grid.material.transparent = true\n  scene.add(grid)\n\n  // lights\n  const hemiLight = new THREE.HemisphereLight(0xffffff, 0x444444)\n  hemiLight.position.set(0, 200, 0)\n  scene.add(hemiLight)\n\n  const directionalLight = new THREE.DirectionalLight(lightColor)\n  directionalLight.position.set(0, 200, 100)\n  directionalLight.castShadow = true\n  directionalLight.shadow.camera.top = 180\n  directionalLight.shadow.camera.bottom = -100\n  directionalLight.shadow.camera.left = -120\n  directionalLight.shadow.camera.right = 120\n  scene.add(directionalLight)\n\n  // adding stl to scene\n  const loader = new STLLoader()\n  loader.load(url, (geometry) => {\n    const material = new THREE.MeshPhongMaterial({\n      color: objectColor,\n      specular: 0x111111,\n      shininess: 200\n    })\n    const mesh = new THREE.Mesh(geometry, material)\n\n    mesh.position.set(0, 0, 0)\n    mesh.rotation.set(-Math.PI / 2, 0, 0)\n    mesh.scale.set(1, 1, 1)\n\n    mesh.castShadow = true\n    mesh.receiveShadow = true\n\n    const signedVolumeOfTriangle = (p1, p2, p3) => {\n      return p1.dot(p2.cross(p3)) / 6.0\n    }\n    let position = geometry.attributes.position\n    let faces = position.count / 3\n    let sum = 0\n    let p1 = new THREE.Vector3(),\n      p2 = new THREE.Vector3(),\n      p3 = new THREE.Vector3()\n    for (let i = 0; i < faces; i++) {\n      p1.fromBufferAttribute(position, i * 3 + 0)\n      p2.fromBufferAttribute(position, i * 3 + 1)\n      p3.fromBufferAttribute(position, i * 3 + 2)\n      sum += signedVolumeOfTriangle(p1, p2, p3)\n    }\n    volume(sum)\n\n    scene.add(mesh)\n  })\n\n  // renderer\n\n  renderer.setPixelRatio(window.devicePixelRatio)\n  renderer.outputEncoding = THREE.sRGBEncoding\n\n  renderer.shadowMap.enabled = true\n\n  function onWindowResize() {\n    camera.aspect = window.innerWidth / height\n    camera.updateProjectionMatrix()\n\n    renderer.setSize(window.innerWidth, height)\n  }\n\n  const animate = () => {\n    requestAnimationFrame(animate)\n    render()\n  }\n\n  const render = () => {\n    camera.lookAt(cameraTarget)\n    renderer.render(scene, camera)\n  }\n  animate()\n  // window.addEventListener('resize', onWindowResize)\n}\n","import React, { useEffect } from 'react'\nimport Stl from './Stl'\n\nexport const StlViewer = ({\n  width,\n  height,\n  url,\n  objectColor,\n  gridLineColor,\n  skyboxColor,\n  groundColor,\n  lightColor,\n  volume\n}) => {\n  useEffect(() => {\n    Stl(\n      width,\n      height,\n      url,\n      objectColor,\n      gridLineColor,\n      skyboxColor,\n      groundColor,\n      lightColor,\n      volume\n    )\n  }, [url])\n  return <div id='stlviewer'></div>\n}\n","import React, { useState } from 'react'\n\nimport { StlViewer } from 'react-stl-file-viewer'\nimport { Box, Button, Flex, Heading, Image } from '@chakra-ui/react'\nconst App = () => {\n  const [photo, setphoto] = useState('')\n  const [volume, setvolume] = useState(0)\n  function getFrame() {\n    let canvas = document.getElementsByTagName('canvas')[0]\n    return canvas.toDataURL()\n  }\n\n  const handleOnClick = () => {\n    setphoto(getFrame())\n  }\n  return (\n    <div>\n      <Flex flexGrow={1} padding={1}>\n        <Box border='1px'>\n          <Heading as='h3' size='md'>\n            Canvas\n          </Heading>\n          <StlViewer\n            width={500}\n            height={500}\n            url='elephant.stl'\n            groundColor='rgb(255, 255, 255)'\n            objectColor='rgb(50, 255, 255)'\n            skyboxColor='rgb(255, 255, 255)'\n            gridLineColor='rgb(0, 0, 0)'\n            lightColor='rgb(255, 255, 255)'\n            volume={setvolume}\n          />\n          {`Volume: ${volume.toFixed(2)} cm3`}\n        </Box>\n\n        <Box border='5px'>\n          <Heading as='h3' size='md'>\n            Photo\n          </Heading>\n          <Image src={photo} />\n        </Box>\n      </Flex>\n      <Button onClick={handleOnClick}>Take Photo</Button>\n    </div>\n  )\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport { ChakraProvider } from '@chakra-ui/react'\nReactDOM.render(\n  <ChakraProvider resetCSS={true}>\n    <App />\n  </ChakraProvider>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}